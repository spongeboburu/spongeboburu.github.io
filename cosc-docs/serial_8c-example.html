<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>cosc: serial.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">cosc<span id="projectnumber">&#160;0.1.0</span>
   </div>
   <div id="projectbrief">OSC library for C99 or C++11.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('serial_8c-example.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">serial.c</div></div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdbool.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="cosc_8h.html">cosc.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">char</span> buffer[1024] = {0};</div>
<div class="line">    <span class="keyword">struct </span><a id="_a0" name="_a0"></a><a class="code hl_struct" href="structcosc__level.html">cosc_level</a> levels[4];</div>
<div class="line">    <a class="code hl_typedef" href="cosc_8h.html#a041183dc7343166fd366a35f6dd3ee5f">cosc_int32</a> ret;</div>
<div class="line">    <span class="keyword">struct </span><a id="_a1" name="_a1"></a><a class="code hl_struct" href="structcosc__serial.html">cosc_serial</a> serial;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Setup the writer.</span></div>
<div class="line">    <a id="a2" name="a2"></a><a class="code hl_function" href="cosc_8h.html#a1e12a763bb29311b983c7596e5891ee3">cosc_writer_setup</a>(</div>
<div class="line">        &amp;serial,</div>
<div class="line">        buffer, <span class="keyword">sizeof</span>(buffer), <span class="comment">// Store to this buffer.</span></div>
<div class="line">        <a id="a3" name="a3"></a><a class="code hl_variable" href="structcosc__serial.html#af4e5b153690c1b4fbfecd5c28ec08bcd">levels</a>, 4, <span class="comment">// Provide 4 levels, 1 is minimum.</span></div>
<div class="line">        0 <span class="comment">// Zero flags.</span></div>
<div class="line">    );</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Timetag to 3.5 seconds.</span></div>
<div class="line">    <a class="code hl_typedef" href="cosc_8h.html#a282949645489b91e3dad719ee1a3bbcd">cosc_uint64</a> timetag = <a id="a4" name="a4"></a><a class="code hl_function" href="cosc_8h.html#a7afca84568df472bb88edb567612165d">cosc_time_to_timetag</a>(3, 500000000);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Start with a bundle (we could start with a message directly too).</span></div>
<div class="line">    ret = <a id="a5" name="a5"></a><a class="code hl_function" href="cosc_8h.html#afb2b7ce6a07580e0320a458ead6d9e36">cosc_writer_start_bundle</a>(&amp;serial, timetag);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Uh oh, couldn&#39;t start writing bundle: %d\n&quot;</span>, ret);</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// We could use cosc_writer_message(&amp;serial, &amp;message, NULL) to write</span></div>
<div class="line">    <span class="comment">// an entire message, but we want to nest things in the blob so</span></div>
<div class="line">    <span class="comment">// let&#39;s go for an start message.</span></div>
<div class="line">    ret = <a id="a6" name="a6"></a><a class="code hl_function" href="cosc_8h.html#acc4e2cfba3dd0b67e5bcb81638ece2e1">cosc_writer_start_message</a>(&amp;serial, <span class="stringliteral">&quot;/address&quot;</span>, 1024, <span class="stringliteral">&quot;,ibf&quot;</span>, 1024);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Uh oh, couldn&#39;t start writing message: %d\n&quot;</span>, ret);</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// The first value is &#39;i&#39;.</span></div>
<div class="line">    ret = <a id="a7" name="a7"></a><a class="code hl_function" href="cosc_8h.html#ab816c5e2d45926d1961b175b3a4d0d05">cosc_writer_int32</a>(&amp;serial, 150);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Uh oh, couldn&#39;t write &#39;i&#39;: %d\n&quot;</span>, ret);</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// We could write the entire blob like this:</span></div>
<div class="line">    <span class="comment">// ret = cosc_writer_blob(&amp;serial, blob_data, blob_size);</span></div>
<div class="line">    <span class="comment">// But we want to nest another message into the blob.</span></div>
<div class="line">    ret = <a id="a8" name="a8"></a><a class="code hl_function" href="cosc_8h.html#a44a43e46f846a0751c684a77ca8ffc24">cosc_writer_start_blob</a>(&amp;serial);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Uh oh, couldn&#39;t start writing blob: %d\n&quot;</span>, ret);</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// With the blob start all other writes will be stored to the blob,</span></div>
<div class="line">    <span class="comment">// but we want a message. We could do it like this:</span></div>
<div class="line">    <span class="comment">// cosc_writer_message(&amp;serial, &amp;message, NULL);</span></div>
<div class="line">    <span class="comment">// But let&#39;s do it with an start message instead.</span></div>
<div class="line">    ret = <a class="code hl_function" href="cosc_8h.html#acc4e2cfba3dd0b67e5bcb81638ece2e1">cosc_writer_start_message</a>(&amp;serial, <span class="stringliteral">&quot;/nested&quot;</span>, 1024, <span class="stringliteral">&quot;,i&quot;</span>, 1024);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Uh oh, couldn&#39;t start writing nested message: %d\n&quot;</span>, ret);</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">// The first value is &#39;i&#39;.</span></div>
<div class="line">    ret = <a class="code hl_function" href="cosc_8h.html#ab816c5e2d45926d1961b175b3a4d0d05">cosc_writer_int32</a>(&amp;serial, 12345678);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Uh oh, couldn&#39;t write &#39;i&#39;: %d\n&quot;</span>, ret);</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Let&#39;s end the message nested message.</span></div>
<div class="line">    ret = <a id="a9" name="a9"></a><a class="code hl_function" href="cosc_8h.html#af07900cbf93773081cd7cc9e2c92b08a">cosc_writer_end_message</a>(&amp;serial);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Uh oh, couldn&#39;t end writing the nested message: %d\n&quot;</span>, ret);</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Let&#39;s end the blob.</span></div>
<div class="line">    ret = <a id="a10" name="a10"></a><a class="code hl_function" href="cosc_8h.html#ab9f6c73251d8dcd4082028650407448d">cosc_writer_end_blob</a>(&amp;serial);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Uh oh, couldn&#39;t end writing the blob: %d\n&quot;</span>, ret);</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Now we&#39;re back to the first message, let&#39;s wrap it up with</span></div>
<div class="line">    <span class="comment">// it&#39;s third and final value of type &#39;f&#39;.</span></div>
<div class="line">    ret = <a id="a11" name="a11"></a><a class="code hl_function" href="cosc_8h.html#a54d20c745d6cd93fef40e7659d49d39d">cosc_writer_float32</a>(&amp;serial, 1.5);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Uh oh, couldn&#39;t write &#39;f&#39;: %d\n&quot;</span>, ret);</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Done, let&#39;s end the message.</span></div>
<div class="line">    ret = <a class="code hl_function" href="cosc_8h.html#af07900cbf93773081cd7cc9e2c92b08a">cosc_writer_end_message</a>(&amp;serial);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Uh oh, couldn&#39;t end writing the message: %d\n&quot;</span>, ret);</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Done, let&#39;s end the bundle.</span></div>
<div class="line">    ret = <a id="a12" name="a12"></a><a class="code hl_function" href="cosc_8h.html#a8c730d131b5ccb5b155d4161215ba42e">cosc_writer_end_bundle</a>(&amp;serial);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Uh oh, couldn&#39;t end writing the bundle: %d\n&quot;</span>, ret);</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// How big was it?</span></div>
<div class="line">    printf(<span class="stringliteral">&quot;Wrote %d bytes of OSC data.\n&quot;</span>, <a id="a13" name="a13"></a><a class="code hl_function" href="cosc_8h.html#a9e5f6cd710b73ebc3ea4f052217b1bf4">cosc_serial_get_size</a>(&amp;serial));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// We could dump the buffer to see what it looks like.</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_function" href="cosc_8h.html#a9e5f6cd710b73ebc3ea4f052217b1bf4">cosc_serial_get_size</a>(&amp;serial); i++)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;%03d: 0x%02x &#39;%c&#39;\n&quot;</span>, i, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)buffer[i], buffer[i] &gt; 31 ? buffer[i] : <span class="charliteral">&#39; &#39;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Now to read it all.</span></div>
<div class="line">    <a id="a14" name="a14"></a><a class="code hl_function" href="cosc_8h.html#ac9755f3c33086f431bac1d666a95ea19">cosc_reader_setup</a>(</div>
<div class="line">        &amp;serial,</div>
<div class="line">        buffer, <a class="code hl_function" href="cosc_8h.html#a9e5f6cd710b73ebc3ea4f052217b1bf4">cosc_serial_get_size</a>(&amp;serial), <span class="comment">// Load from this buffer using the written size.</span></div>
<div class="line">        <a class="code hl_variable" href="structcosc__serial.html#af4e5b153690c1b4fbfecd5c28ec08bcd">levels</a>, 4, <span class="comment">// Levels.</span></div>
<div class="line">        0 <span class="comment">// No flags.</span></div>
<div class="line">    );</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Let&#39;s just make sure we have a bundle</span></div>
<div class="line">    <span class="keywordflow">if</span> (<a id="a15" name="a15"></a><a class="code hl_function" href="cosc_8h.html#a179abe774084a76469f328c8132dac4a">cosc_reader_peek_bundle</a>(&amp;serial, NULL, NULL) &lt; 0)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Uh oh, not a bundle? %d\n&quot;</span>, ret);</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// The bundle.</span></div>
<div class="line">    timetag = 0; <span class="comment">// Just to make sure we actuall did read it.</span></div>
<div class="line">    ret = <a id="a16" name="a16"></a><a class="code hl_function" href="cosc_8h.html#a7a0a0098659448b8d7a62387b2f9c644">cosc_reader_start_bundle</a>(&amp;serial, &amp;timetag);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Uh oh, couldn&#39;t start bundle: %d\n&quot;</span>, ret);</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_typedef" href="cosc_8h.html#af038df0df37304e201834983c287c29b">cosc_uint32</a> nanos;</div>
<div class="line">    <a class="code hl_typedef" href="cosc_8h.html#af038df0df37304e201834983c287c29b">cosc_uint32</a> seconds = <a id="a17" name="a17"></a><a class="code hl_function" href="cosc_8h.html#a7a9793b6b2b63baf1f532f8819d2b394">cosc_timetag_to_time</a>(timetag, &amp;nanos);</div>
<div class="line">    printf(<span class="stringliteral">&quot;Timetag is %f.\n&quot;</span>, (<span class="keywordtype">double</span>)seconds + nanos / 1000000000.0);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Start the message.</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *address, *typetag;</div>
<div class="line">    <a class="code hl_typedef" href="cosc_8h.html#a041183dc7343166fd366a35f6dd3ee5f">cosc_int32</a> address_len, typetag_len;</div>
<div class="line">    ret = <a id="a18" name="a18"></a><a class="code hl_function" href="cosc_8h.html#a34c33ad0953d83a24715b2c9ee3e8670">cosc_reader_start_message</a>(</div>
<div class="line">        &amp;serial,</div>
<div class="line">        &amp;address, &amp;address_len,</div>
<div class="line">        &amp;typetag, &amp;typetag_len</div>
<div class="line">    );</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Uh oh, couldn&#39;t start message: %d\n&quot;</span>, ret);</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">    printf(<span class="stringliteral">&quot;Address &#39;%s&#39; and typetag &#39;%s&#39;\n&quot;</span>, address, typetag);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// First value</span></div>
<div class="line">    <a class="code hl_typedef" href="cosc_8h.html#a041183dc7343166fd366a35f6dd3ee5f">cosc_int32</a> value_i;</div>
<div class="line">    ret = <a id="a19" name="a19"></a><a class="code hl_function" href="cosc_8h.html#a0f19a5f0a53dd350f9591999327e4004">cosc_reader_int32</a>(&amp;serial, &amp;value_i);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Uh oh, couldn&#39;t read &#39;i&#39;: %d\n&quot;</span>, ret);</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">    printf(<span class="stringliteral">&quot;Value &#39;i&#39;: %d\n&quot;</span>, value_i);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Then the blob.</span></div>
<div class="line">    <a class="code hl_typedef" href="cosc_8h.html#a041183dc7343166fd366a35f6dd3ee5f">cosc_int32</a> blob_size;</div>
<div class="line">    ret = <a id="a20" name="a20"></a><a class="code hl_function" href="cosc_8h.html#a9b127c92ba909e6fdccd730e94bd98a4">cosc_reader_start_blob</a>(&amp;serial, &amp;blob_size);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Uh oh, couldn&#39;t start blob: %d\n&quot;</span>, ret);</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">    printf(<span class="stringliteral">&quot;Blob is %d bytes.\n&quot;</span>, blob_size);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// We know we put a message in here, let&#39;s do the shorthand</span></div>
<div class="line">    <span class="comment">// function this time. We need to store the values which</span></div>
<div class="line">    <span class="comment">// is only 1 &#39;i&#39; value.</span></div>
<div class="line">    <span class="keyword">union </span><a id="_a21" name="_a21"></a><a class="code hl_union" href="unioncosc__value.html">cosc_value</a> values[1];</div>
<div class="line">    <span class="keyword">struct </span><a id="_a22" name="_a22"></a><a class="code hl_struct" href="structcosc__message.html">cosc_message</a> message = {</div>
<div class="line">        .values = {.read = <a id="a23" name="a23"></a><a class="code hl_variable" href="structcosc__message.html#a461adf6e14f391d6cdc09f999c0f71c7">values</a>},</div>
<div class="line">        .values_n = 1</div>
<div class="line">    };</div>
<div class="line">    <a class="code hl_typedef" href="cosc_8h.html#a041183dc7343166fd366a35f6dd3ee5f">cosc_int32</a> value_count; <span class="comment">// We can see the actual number of values here.</span></div>
<div class="line">    ret = <a id="a24" name="a24"></a><a class="code hl_function" href="cosc_8h.html#a0dfa80d1118500e4d350ab7144aeb567">cosc_reader_message</a>(&amp;serial, &amp;message, &amp;value_count, <span class="keyword">true</span>);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Uh oh, couldn&#39;t read nested message: %d\n&quot;</span>, ret);</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">    printf(<span class="stringliteral">&quot;Address=&#39;%s&#39;, Typetag=&#39;%s&#39;\n&quot;</span>, message.<a id="a25" name="a25"></a><a class="code hl_variable" href="structcosc__message.html#a9a1ee8608f797486851dee77c3ef145f">address</a>, message.<a id="a26" name="a26"></a><a class="code hl_variable" href="structcosc__message.html#a95d762595dbc65c2af7de7f0f850dac1">typetag</a>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;Nested message has %d values.\n&quot;</span>, value_count);</div>
<div class="line">    printf(<span class="stringliteral">&quot;Value &#39;i&#39;: %d\n&quot;</span>, <a class="code hl_variable" href="structcosc__message.html#a461adf6e14f391d6cdc09f999c0f71c7">values</a>[0].i);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Close the blob.</span></div>
<div class="line">    ret = <a id="a27" name="a27"></a><a class="code hl_function" href="cosc_8h.html#ac9ba4a17ab95889995de5897481df92f">cosc_reader_end_blob</a>(&amp;serial);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Uh oh, couldn&#39;t close the blob: %d\n&quot;</span>, ret);</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Final value of the top message.</span></div>
<div class="line">    <a class="code hl_typedef" href="cosc_8h.html#af441c39da6c58da4845cc4fc152d2c98">cosc_float32</a> value_f;</div>
<div class="line">    ret = <a id="a28" name="a28"></a><a class="code hl_function" href="cosc_8h.html#a762d2ccd106a1a18fcf45c30f964b15a">cosc_reader_float32</a>(&amp;serial, &amp;value_f);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Uh oh, couldn&#39;t read &#39;f&#39;: %d\n&quot;</span>, ret);</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">    printf(<span class="stringliteral">&quot;Final float is %f\n&quot;</span>, value_f);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// We need to end the top message.</span></div>
<div class="line">    ret = <a id="a29" name="a29"></a><a class="code hl_function" href="cosc_8h.html#a48fe98db06782e89e486feba2516f52a">cosc_reader_end_message</a>(&amp;serial, <span class="keyword">true</span>);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Uh oh, couldn&#39;t end the message: %d\n&quot;</span>, ret);</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// We need to end the bundle.</span></div>
<div class="line">    ret = <a id="a30" name="a30"></a><a class="code hl_function" href="cosc_8h.html#a0d40e9de39255777fb78d983dd78c4fd">cosc_reader_end_bundle</a>(&amp;serial);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">    {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Uh oh, couldn&#39;t end the message: %d\n&quot;</span>, ret);</div>
<div class="line">        <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// How big was it?</span></div>
<div class="line">    printf(<span class="stringliteral">&quot;Read %d bytes of OSC data.\n&quot;</span>, <a class="code hl_function" href="cosc_8h.html#a9e5f6cd710b73ebc3ea4f052217b1bf4">cosc_serial_get_size</a>(&amp;serial));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="acosc_8h_html"><div class="ttname"><a href="cosc_8h.html">cosc.h</a></div><div class="ttdoc">OSC library for C99 or C++11.</div></div>
<div class="ttc" id="acosc_8h_html_a041183dc7343166fd366a35f6dd3ee5f"><div class="ttname"><a href="cosc_8h.html#a041183dc7343166fd366a35f6dd3ee5f">cosc_int32</a></div><div class="ttdeci">COSC_TYPE_INT32 cosc_int32</div><div class="ttdoc">Signed 32-bit integer.</div><div class="ttdef"><b>Definition</b> cosc.h:253</div></div>
<div class="ttc" id="acosc_8h_html_a0d40e9de39255777fb78d983dd78c4fd"><div class="ttname"><a href="cosc_8h.html#a0d40e9de39255777fb78d983dd78c4fd">cosc_reader_end_bundle</a></div><div class="ttdeci">COSC_API cosc_int32 cosc_reader_end_bundle(struct cosc_serial *serial)</div><div class="ttdoc">End a bundle level.</div><div class="ttdef"><b>Definition</b> cosc.c:2907</div></div>
<div class="ttc" id="acosc_8h_html_a0dfa80d1118500e4d350ab7144aeb567"><div class="ttname"><a href="cosc_8h.html#a0dfa80d1118500e4d350ab7144aeb567">cosc_reader_message</a></div><div class="ttdeci">COSC_API cosc_int32 cosc_reader_message(struct cosc_serial *serial, struct cosc_message *message, cosc_int32 *value_count, cosc_int32 exit_early)</div><div class="ttdoc">Read an OSC message.</div><div class="ttdef"><b>Definition</b> cosc.c:3237</div></div>
<div class="ttc" id="acosc_8h_html_a0f19a5f0a53dd350f9591999327e4004"><div class="ttname"><a href="cosc_8h.html#a0f19a5f0a53dd350f9591999327e4004">cosc_reader_int32</a></div><div class="ttdeci">COSC_API cosc_int32 cosc_reader_int32(struct cosc_serial *serial, cosc_int32 *value)</div><div class="ttdoc">Write a signed 32-bit integer.</div><div class="ttdef"><b>Definition</b> cosc.c:3064</div></div>
<div class="ttc" id="acosc_8h_html_a179abe774084a76469f328c8132dac4a"><div class="ttname"><a href="cosc_8h.html#a179abe774084a76469f328c8132dac4a">cosc_reader_peek_bundle</a></div><div class="ttdeci">COSC_API cosc_int32 cosc_reader_peek_bundle(struct cosc_serial *serial, cosc_uint64 *timetag, cosc_int32 *psize)</div><div class="ttdoc">Check if the buffer has a bundle at the current read size.</div><div class="ttdef"><b>Definition</b> cosc.c:2858</div></div>
<div class="ttc" id="acosc_8h_html_a1e12a763bb29311b983c7596e5891ee3"><div class="ttname"><a href="cosc_8h.html#a1e12a763bb29311b983c7596e5891ee3">cosc_writer_setup</a></div><div class="ttdeci">COSC_API void cosc_writer_setup(struct cosc_serial *serial, void *buffer, cosc_int32 buffer_size, struct cosc_level *levels, cosc_int32 level_max, cosc_uint32 flags)</div><div class="ttdoc">Setup a serial for writing.</div><div class="ttdef"><b>Definition</b> cosc.c:2408</div></div>
<div class="ttc" id="acosc_8h_html_a282949645489b91e3dad719ee1a3bbcd"><div class="ttname"><a href="cosc_8h.html#a282949645489b91e3dad719ee1a3bbcd">cosc_uint64</a></div><div class="ttdeci">COSC_TYPE_UINT64 cosc_uint64</div><div class="ttdoc">Unsigned 64-bit integer.</div><div class="ttdef"><b>Definition</b> cosc.h:345</div></div>
<div class="ttc" id="acosc_8h_html_a34c33ad0953d83a24715b2c9ee3e8670"><div class="ttname"><a href="cosc_8h.html#a34c33ad0953d83a24715b2c9ee3e8670">cosc_reader_start_message</a></div><div class="ttdeci">COSC_API cosc_int32 cosc_reader_start_message(struct cosc_serial *serial, const char **address, cosc_int32 *address_n, const char **typetag, cosc_int32 *typetag_n)</div><div class="ttdoc">Start a new message level.</div><div class="ttdef"><b>Definition</b> cosc.c:2921</div></div>
<div class="ttc" id="acosc_8h_html_a44a43e46f846a0751c684a77ca8ffc24"><div class="ttname"><a href="cosc_8h.html#a44a43e46f846a0751c684a77ca8ffc24">cosc_writer_start_blob</a></div><div class="ttdeci">COSC_API cosc_int32 cosc_writer_start_blob(struct cosc_serial *serial)</div><div class="ttdoc">Start a new blob level.</div><div class="ttdef"><b>Definition</b> cosc.c:2525</div></div>
<div class="ttc" id="acosc_8h_html_a48fe98db06782e89e486feba2516f52a"><div class="ttname"><a href="cosc_8h.html#a48fe98db06782e89e486feba2516f52a">cosc_reader_end_message</a></div><div class="ttdeci">COSC_API cosc_int32 cosc_reader_end_message(struct cosc_serial *serial, cosc_int32 exit_early)</div><div class="ttdoc">End a message level.</div><div class="ttdef"><b>Definition</b> cosc.c:2973</div></div>
<div class="ttc" id="acosc_8h_html_a54d20c745d6cd93fef40e7659d49d39d"><div class="ttname"><a href="cosc_8h.html#a54d20c745d6cd93fef40e7659d49d39d">cosc_writer_float32</a></div><div class="ttdeci">COSC_API cosc_int32 cosc_writer_float32(struct cosc_serial *serial, cosc_float32 value)</div><div class="ttdoc">Write a 32-bit float.</div><div class="ttdef"><b>Definition</b> cosc.c:2590</div></div>
<div class="ttc" id="acosc_8h_html_a762d2ccd106a1a18fcf45c30f964b15a"><div class="ttname"><a href="cosc_8h.html#a762d2ccd106a1a18fcf45c30f964b15a">cosc_reader_float32</a></div><div class="ttdeci">COSC_API cosc_int32 cosc_reader_float32(struct cosc_serial *serial, cosc_float32 *value)</div><div class="ttdoc">Write a 32-bit float.</div><div class="ttdef"><b>Definition</b> cosc.c:3077</div></div>
<div class="ttc" id="acosc_8h_html_a7a0a0098659448b8d7a62387b2f9c644"><div class="ttname"><a href="cosc_8h.html#a7a0a0098659448b8d7a62387b2f9c644">cosc_reader_start_bundle</a></div><div class="ttdeci">COSC_API cosc_int32 cosc_reader_start_bundle(struct cosc_serial *serial, cosc_uint64 *timetag)</div><div class="ttdoc">Start a new bundle level.</div><div class="ttdef"><b>Definition</b> cosc.c:2880</div></div>
<div class="ttc" id="acosc_8h_html_a7a9793b6b2b63baf1f532f8819d2b394"><div class="ttname"><a href="cosc_8h.html#a7a9793b6b2b63baf1f532f8819d2b394">cosc_timetag_to_time</a></div><div class="ttdeci">COSC_API cosc_uint32 cosc_timetag_to_time(cosc_uint64 timetag, cosc_uint32 *nanos)</div><div class="ttdoc">Convert a timetag to seconds and nanoseconds.</div><div class="ttdef"><b>Definition</b> cosc.c:970</div></div>
<div class="ttc" id="acosc_8h_html_a7afca84568df472bb88edb567612165d"><div class="ttname"><a href="cosc_8h.html#a7afca84568df472bb88edb567612165d">cosc_time_to_timetag</a></div><div class="ttdeci">COSC_API cosc_uint64 cosc_time_to_timetag(cosc_uint32 seconds, cosc_uint32 nanos)</div><div class="ttdoc">Convert time to a timetag.</div><div class="ttdef"><b>Definition</b> cosc.c:996</div></div>
<div class="ttc" id="acosc_8h_html_a8c730d131b5ccb5b155d4161215ba42e"><div class="ttname"><a href="cosc_8h.html#a8c730d131b5ccb5b155d4161215ba42e">cosc_writer_end_bundle</a></div><div class="ttdeci">COSC_API cosc_int32 cosc_writer_end_bundle(struct cosc_serial *serial)</div><div class="ttdoc">End a bundle level.</div><div class="ttdef"><b>Definition</b> cosc.c:2442</div></div>
<div class="ttc" id="acosc_8h_html_a9b127c92ba909e6fdccd730e94bd98a4"><div class="ttname"><a href="cosc_8h.html#a9b127c92ba909e6fdccd730e94bd98a4">cosc_reader_start_blob</a></div><div class="ttdeci">COSC_API cosc_int32 cosc_reader_start_blob(struct cosc_serial *serial, cosc_int32 *value_size)</div><div class="ttdoc">Start a new blob level.</div><div class="ttdef"><b>Definition</b> cosc.c:3006</div></div>
<div class="ttc" id="acosc_8h_html_a9e5f6cd710b73ebc3ea4f052217b1bf4"><div class="ttname"><a href="cosc_8h.html#a9e5f6cd710b73ebc3ea4f052217b1bf4">cosc_serial_get_size</a></div><div class="ttdeci">COSC_API cosc_int32 cosc_serial_get_size(const struct cosc_serial *serial)</div><div class="ttdoc">Get the number of written or read bytes.</div><div class="ttdef"><b>Definition</b> cosc.c:2371</div></div>
<div class="ttc" id="acosc_8h_html_ab816c5e2d45926d1961b175b3a4d0d05"><div class="ttname"><a href="cosc_8h.html#ab816c5e2d45926d1961b175b3a4d0d05">cosc_writer_int32</a></div><div class="ttdeci">COSC_API cosc_int32 cosc_writer_int32(struct cosc_serial *serial, cosc_int32 value)</div><div class="ttdoc">Write a signed 32-bit integer.</div><div class="ttdef"><b>Definition</b> cosc.c:2577</div></div>
<div class="ttc" id="acosc_8h_html_ab9f6c73251d8dcd4082028650407448d"><div class="ttname"><a href="cosc_8h.html#ab9f6c73251d8dcd4082028650407448d">cosc_writer_end_blob</a></div><div class="ttdeci">COSC_API cosc_int32 cosc_writer_end_blob(struct cosc_serial *serial)</div><div class="ttdoc">End a blob level.</div><div class="ttdef"><b>Definition</b> cosc.c:2543</div></div>
<div class="ttc" id="acosc_8h_html_ac9755f3c33086f431bac1d666a95ea19"><div class="ttname"><a href="cosc_8h.html#ac9755f3c33086f431bac1d666a95ea19">cosc_reader_setup</a></div><div class="ttdeci">COSC_API void cosc_reader_setup(struct cosc_serial *serial, const void *buffer, cosc_int32 buffer_size, struct cosc_level *levels, cosc_int32 level_max, cosc_uint32 flags)</div><div class="ttdoc">Setup a serial for reading.</div><div class="ttdef"><b>Definition</b> cosc.c:2846</div></div>
<div class="ttc" id="acosc_8h_html_ac9ba4a17ab95889995de5897481df92f"><div class="ttname"><a href="cosc_8h.html#ac9ba4a17ab95889995de5897481df92f">cosc_reader_end_blob</a></div><div class="ttdeci">COSC_API cosc_int32 cosc_reader_end_blob(struct cosc_serial *serial)</div><div class="ttdoc">End a blob level.</div><div class="ttdef"><b>Definition</b> cosc.c:3032</div></div>
<div class="ttc" id="acosc_8h_html_acc4e2cfba3dd0b67e5bcb81638ece2e1"><div class="ttname"><a href="cosc_8h.html#acc4e2cfba3dd0b67e5bcb81638ece2e1">cosc_writer_start_message</a></div><div class="ttdeci">COSC_API cosc_int32 cosc_writer_start_message(struct cosc_serial *serial, const char *address, cosc_int32 address_n, const char *typetag, cosc_int32 typetag_n)</div><div class="ttdoc">Start a new message level.</div><div class="ttdef"><b>Definition</b> cosc.c:2456</div></div>
<div class="ttc" id="acosc_8h_html_af038df0df37304e201834983c287c29b"><div class="ttname"><a href="cosc_8h.html#af038df0df37304e201834983c287c29b">cosc_uint32</a></div><div class="ttdeci">COSC_TYPE_UINT32 cosc_uint32</div><div class="ttdoc">Unsigned 32-bit integer.</div><div class="ttdef"><b>Definition</b> cosc.h:248</div></div>
<div class="ttc" id="acosc_8h_html_af07900cbf93773081cd7cc9e2c92b08a"><div class="ttname"><a href="cosc_8h.html#af07900cbf93773081cd7cc9e2c92b08a">cosc_writer_end_message</a></div><div class="ttdeci">COSC_API cosc_int32 cosc_writer_end_message(struct cosc_serial *serial)</div><div class="ttdoc">End a message level.</div><div class="ttdef"><b>Definition</b> cosc.c:2500</div></div>
<div class="ttc" id="acosc_8h_html_af441c39da6c58da4845cc4fc152d2c98"><div class="ttname"><a href="cosc_8h.html#af441c39da6c58da4845cc4fc152d2c98">cosc_float32</a></div><div class="ttdeci">COSC_TYPE_FLOAT32 cosc_float32</div><div class="ttdoc">32-bit floating point.</div><div class="ttdef"><b>Definition</b> cosc.h:350</div></div>
<div class="ttc" id="acosc_8h_html_afb2b7ce6a07580e0320a458ead6d9e36"><div class="ttname"><a href="cosc_8h.html#afb2b7ce6a07580e0320a458ead6d9e36">cosc_writer_start_bundle</a></div><div class="ttdeci">COSC_API cosc_int32 cosc_writer_start_bundle(struct cosc_serial *serial, cosc_uint64 timetag)</div><div class="ttdoc">Start a new bundle level.</div><div class="ttdef"><b>Definition</b> cosc.c:2420</div></div>
<div class="ttc" id="astructcosc__level_html"><div class="ttname"><a href="structcosc__level.html">cosc_level</a></div><div class="ttdoc">Used to manage the levels of a serial.</div><div class="ttdef"><b>Definition</b> cosc.h:603</div></div>
<div class="ttc" id="astructcosc__message_html"><div class="ttname"><a href="structcosc__message.html">cosc_message</a></div><div class="ttdoc">A message.</div><div class="ttdef"><b>Definition</b> cosc.h:536</div></div>
<div class="ttc" id="astructcosc__message_html_a461adf6e14f391d6cdc09f999c0f71c7"><div class="ttname"><a href="structcosc__message.html#a461adf6e14f391d6cdc09f999c0f71c7">cosc_message::values</a></div><div class="ttdeci">union cosc_message::@050073337162334015163030171201070055033256045255 values</div><div class="ttdoc">Const safety.</div></div>
<div class="ttc" id="astructcosc__message_html_a95d762595dbc65c2af7de7f0f850dac1"><div class="ttname"><a href="structcosc__message.html#a95d762595dbc65c2af7de7f0f850dac1">cosc_message::typetag</a></div><div class="ttdeci">const char * typetag</div><div class="ttdoc">The typetag.</div><div class="ttdef"><b>Definition</b> cosc.h:552</div></div>
<div class="ttc" id="astructcosc__message_html_a9a1ee8608f797486851dee77c3ef145f"><div class="ttname"><a href="structcosc__message.html#a9a1ee8608f797486851dee77c3ef145f">cosc_message::address</a></div><div class="ttdeci">const char * address</div><div class="ttdoc">The address.</div><div class="ttdef"><b>Definition</b> cosc.h:541</div></div>
<div class="ttc" id="astructcosc__serial_html"><div class="ttname"><a href="structcosc__serial.html">cosc_serial</a></div><div class="ttdoc">A serial.</div><div class="ttdef"><b>Definition</b> cosc.h:653</div></div>
<div class="ttc" id="astructcosc__serial_html_af4e5b153690c1b4fbfecd5c28ec08bcd"><div class="ttname"><a href="structcosc__serial.html#af4e5b153690c1b4fbfecd5c28ec08bcd">cosc_serial::levels</a></div><div class="ttdeci">struct cosc_level * levels</div><div class="ttdoc">A pointer to an array of levels.</div><div class="ttdef"><b>Definition</b> cosc.h:673</div></div>
<div class="ttc" id="aunioncosc__value_html"><div class="ttname"><a href="unioncosc__value.html">cosc_value</a></div><div class="ttdoc">A value.</div><div class="ttdef"><b>Definition</b> cosc.h:447</div></div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
